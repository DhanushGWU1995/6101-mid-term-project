<!-- Example Angular Template for CHD Prediction -->
<!-- File: src/app/components/rf-prediction/rf-prediction.component.html -->

<div class="prediction-container">
  <h2>Random Forest CHD Risk Prediction</h2>
  <p class="subtitle">Predict coronary heart disease risk using machine learning</p>

  <form [formGroup]="predictionForm" (ngSubmit)="onSubmit()" class="prediction-form">
    
    <!-- Age Group -->
    <div class="form-group">
      <label for="age">Age Group *</label>
      <select id="age" formControlName="Age" class="form-control">
        <option value="">Select age group</option>
        <option *ngFor="let age of ageGroups" [value]="age">{{ age }}</option>
      </select>
    </div>

    <!-- Sex -->
    <div class="form-group">
      <label for="sex">Sex *</label>
      <select id="sex" formControlName="Sex" class="form-control">
        <option value="">Select sex</option>
        <option *ngFor="let sex of sexOptions" [value]="sex">{{ sex }}</option>
      </select>
    </div>

    <!-- BMI Value -->
    <div class="form-group">
      <label for="bmi">BMI Value *</label>
      <input 
        type="number" 
        id="bmi" 
        formControlName="BMI_Value" 
        class="form-control"
        placeholder="e.g., 25.5"
        step="0.1"
        min="10"
        max="70">
      <small class="form-text">Enter a value between 10 and 70</small>
    </div>

    <!-- Smoking Status -->
    <div class="form-group">
      <label for="smoking">Have you smoked 100+ cigarettes in your lifetime? *</label>
      <select id="smoking" formControlName="Smoking_Status" class="form-control">
        <option value="">Select status</option>
        <option *ngFor="let option of yesNoOptions" [value]="option">{{ option }}</option>
      </select>
    </div>

    <!-- Diabetes Status -->
    <div class="form-group">
      <label for="diabetes">Diabetes Status *</label>
      <select id="diabetes" formControlName="Diabetes_Status" class="form-control">
        <option value="">Select status</option>
        <option *ngFor="let option of diabetesOptions" [value]="option">{{ option }}</option>
      </select>
    </div>

    <!-- Exercise -->
    <div class="form-group">
      <label for="exercise">Exercised in the past 30 days? *</label>
      <select id="exercise" formControlName="Exercise_Past_30_Days" class="form-control">
        <option value="">Select status</option>
        <option *ngFor="let option of yesNoOptions" [value]="option">{{ option }}</option>
      </select>
    </div>

    <!-- General Health Status -->
    <div class="form-group">
      <label for="health">General Health Status *</label>
      <select id="health" formControlName="General_Health_Status" class="form-control">
        <option value="">Select status</option>
        <option *ngFor="let option of healthOptions" [value]="option">{{ option }}</option>
      </select>
    </div>

    <!-- Submit Buttons -->
    <div class="button-group">
      <button 
        type="submit" 
        class="btn btn-primary"
        [disabled]="!predictionForm.valid || loading">
        <span *ngIf="!loading">Predict Risk</span>
        <span *ngIf="loading">Analyzing...</span>
      </button>
      <button 
        type="button" 
        class="btn btn-secondary"
        (click)="resetForm()"
        [disabled]="loading">
        Reset
      </button>
    </div>
  </form>

  <!-- Error Message -->
  <div *ngIf="error" class="alert alert-error">
    <strong>Error:</strong> {{ error }}
  </div>

  <!-- Prediction Results -->
  <div *ngIf="prediction && prediction.success" class="prediction-result">
    <h3>Prediction Results</h3>
    
    <div class="risk-card" [style.border-left-color]="getRiskColor()">
      <div class="risk-header">
        <h4>Risk Level: {{ prediction.prediction.risk_level }}</h4>
        <div class="risk-probability" [style.color]="getRiskColor()">
          {{ prediction.prediction.chd_probability }}%
        </div>
      </div>
      
      <div class="risk-indicator">
        <div class="risk-bar">
          <div 
            class="risk-fill" 
            [style.width.%]="prediction.prediction.chd_probability"
            [style.background-color]="getRiskColor()">
          </div>
        </div>
      </div>

      <div class="risk-interpretation">
        <p *ngIf="prediction.prediction.risk_level === 'Low'" class="text-success">
          ✓ Your risk of coronary heart disease is low. Continue maintaining a healthy lifestyle.
        </p>
        <p *ngIf="prediction.prediction.risk_level === 'Moderate'" class="text-warning">
          ⚠ Your risk is moderate. Consider lifestyle modifications and consult your healthcare provider.
        </p>
        <p *ngIf="prediction.prediction.risk_level === 'High'" class="text-danger">
          ⚠ Your risk is elevated. Please consult with a healthcare professional.
        </p>
        <p *ngIf="prediction.prediction.risk_level === 'Very High'" class="text-danger">
          ⚠⚠ Your risk is very high. Immediate medical consultation is strongly recommended.
        </p>
      </div>
    </div>

    <!-- Model Information -->
    <div class="model-info">
      <h4>About This Prediction</h4>
      <p>This prediction is based on a Random Forest machine learning model trained on BRFSS 2024 data with the following factors:</p>
      <ul>
        <li>Age Group: {{ prediction.input.Age }}</li>
        <li>Sex: {{ prediction.input.Sex }}</li>
        <li>BMI: {{ prediction.input.BMI_Value }}</li>
        <li>Smoking Status: {{ prediction.input.Smoking_Status }}</li>
        <li>Diabetes Status: {{ prediction.input.Diabetes_Status }}</li>
        <li>Exercise (Past 30 Days): {{ prediction.input.Exercise_Past_30_Days }}</li>
        <li>General Health: {{ prediction.input.General_Health_Status }}</li>
      </ul>
      <p class="disclaimer">
        <strong>Disclaimer:</strong> This is a predictive model for educational purposes only. 
        It should not replace professional medical advice, diagnosis, or treatment.
      </p>
    </div>
  </div>
</div>
